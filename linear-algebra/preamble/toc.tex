
\contentsmargin{0cm}
\titlecontents{chapter}[3.7pc]
{
  \addvspace{30pt}
	\begin{tikzpicture}[remember picture, overlay]
		\draw[fill=doc!60,draw=doc!60] (-7,-.1) rectangle (-0.9,.5);
		\pgftext[left,x=-3.7cm,y=0.2cm]{\color{white}\Large \chaptername\ \thecontentslabel}
	\end{tikzpicture}\color{doc!60}\large
}
{}{}
{
  \;\titlerule\;\large Page \thecontentspage
	\begin{tikzpicture}[remember picture, overlay]
		\draw[fill=doc!60,draw=doc!60] (2pt,0) rectangle (4,0.1pt);
	\end{tikzpicture}
}

\titlecontents{section}[3.7pc]
{\addvspace{2pt}}
{\contentslabel[\thecontentslabel]{2pc}}
{}
{\hfill\small \thecontentspage}
[]

\titlecontents*{subsection}[3.7pc]
{\addvspace{-1pt}\small}
{}
{}
{\ ---\ \small\thecontentspage}
[ \textbullet\ ][]

\makeatletter

\renewcommand{\tableofcontents}{
	\chapter*{
	  \vspace*{-20\p@}
	  \begin{tikzpicture}[remember picture, overlay]
		  \pgftext[right,x=14.4cm,y=0.2cm]{\color{doc!60}\Huge \contentsname}
		  \draw[fill=doc!60,draw=doc!60] (13,-.75) rectangle (20,1);
		  \clip (13,-.75) rectangle (20,1);
		  \pgftext[right,x=14.4cm,y=0.2cm]{\color{white}\Huge \contentsname}
	  \end{tikzpicture}}
	\@starttoc{toc}}

\makeatother

